## Volatility Transformers: an optimal transport-inspired approach to arbitrage-free shaping of implied volatility surfaces
[Zetocha 2023](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4623940)

### 要点
- この論文は、implied volatility surfaceを無裁定条件を保ったまま調整するための道具立てを最適輸送理論の言葉に基づいて提案している。
    - transportの最適性に関心があるわけではない。transportした先の分布に関心がある。
- やりたい操作は、vol surfaceの外挿や期間構造の変更、スキューの変更など。マーケットのvol surfaceにフィットしたあと、観測不能な部分を内挿・外挿したり、イベントVolに対応するため機関構造を調整するような場面を念頭に置いている。
- 最適輸送理論で考察する対象は各満期における同時確率分布全体のこと。
- 無裁定条件について
    - implied vol surface (=原資産の各満期における確率分布)が無裁定であるための条件は、各満期の分布がconvex orderを満たしていること
    - convex orderを保存するような輸送写像で分布を変換すれば、変換後のvol surfaceも無裁定
    - convex orderを保存する輸送写像は、One-Xパターンによって特徴づけられる
- 具体的な操作として、log normal processやdelayed Merton processを用いた分布変換によるvolの期間構造やskewの調整の構成手順を示している。

### 感想
- vol surfaceを連続確率分布として扱っているので、実用上面倒そう。
    - あまり確率分布そのものを普段扱わないので、感覚が捉えづらい。
    - 連続確率分布に対する最適輸送の構成は、現実的には離散近似するしかなさそう。
        - (今回の論文とはあまり関係ないが)下記参考文献の4章では連続確率分布の最適輸送を扱っているが、ニューラルネットを使用してその有限個の重みパラメータの最適化問題に落とし込み、制約条件を満たすよう条件を加えて解いている。
        - log normalやdelayed Mertonのcdfの逆関数, cdfをパラメータを変えつつ適用することが基本操作になる。元々の確率分布が解析的でないし、結構な手間
        - 離散近似して分布を変換して、その後ふたたびなにかの関数形で補間するのか？その際の無裁定条件は？
        - さらに、vol水準調整、re-centering, skew調整などTransportを当てはめる回数分だけ計算が必要になる。
- １Y smileに対するskew調整のtransportを他の年限に当てはめたり、過去見えていた年限間のsmileの差に対応するtransportを用いてマーケットに存在しない年限のsmileを補間するなど、ある種の構造を保った変換を使う手段としては面白いのかもしれない。マーケットシナリオを作る際に自由に使いやすい可能性はある。ただその輸送がもつモデル上(プライシングモデルに当てはめた観点から)の意味合いを検討する必要がありそう。
    - 例えばセクション８で指摘されているように、Wasserstein距離の意味での時間方向の補間は自然に見えるが**マーケットに合わない**
- 単純な興味として、この意味でマーケットからimplyされる確率分布の距離をhistorical dataに対してクラスタリング等見てみたい


### 参考文献
- [最適輸送の理論とアルゴリズム (機械学習プロフェッショナルシリーズ)](https://www.amazon.co.jp/%E6%9C%80%E9%81%A9%E8%BC%B8%E9%80%81%E3%81%AE%E7%90%86%E8%AB%96%E3%81%A8%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0-%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E3%83%97%E3%83%AD%E3%83%95%E3%82%A7%E3%83%83%E3%82%B7%E3%83%A7%E3%83%8A%E3%83%AB%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-%E4%BD%90%E8%97%A4-%E7%AB%9C%E9%A6%AC/dp/4065305144)

